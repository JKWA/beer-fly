

<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/polymerfire/firebase-document.html">
<link rel="import" href="../bower_components/iron-flex-layout/iron-flex-layout.html">
<link rel="import" href="../bower_components/iron-icons/iron-icons.html">
<link rel="import" href="../bower_components/neon-animation/animations/slide-from-right-animation.html">
<link rel="import" href="../bower_components/neon-animation/animations/slide-right-animation.html">
<link rel="import" href="../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="../bower_components/paper-dialog/paper-dialog.html">
<link rel="import" href="../bower_components/paper-dialog-scrollable/paper-dialog-scrollable.html">
<link rel="import" href="../bower_components/polymerfire/firebase-document.html">
<link rel="import" href="../bower_components/polymerfire/firebase-query.html">
<link rel="import" href="../bower_components/polymerfire/firebase-auth.html">


<link rel="import" href="../my_components/data/upload-image.html">
<link rel="import" href="beer-crawl-dialog.html">
<link rel="import" href="beer-dialog.html">
<link rel="import" href="beer-pub-edit.html">
<link rel="import" href="beer-pub-icons.html">
<link rel="import" href="beer-fab.html">
<link rel="import" href="beer-menu-card-mini.html">
<link rel="import" href="beer-schedule-card-mini.html">
<link rel="import" href="beer-contact-card.html">
<link rel="import" href="beer-hours-card.html">
<link rel="import" href="beer-review-card-mini.html">
<!-- <link rel="import" href="beer-rating-card.html"> -->
<link rel="import" href="beer-beer-card-mini.html">
<!-- <link rel="import" href="beer-pub-favorite.html"> -->
<!-- <link rel="import" href="beer-pub-rating.html"> -->
<link rel="import" href="beer-foodtruck-schedule.html">
<link rel="import" href="beer-banner.html">




<link rel="import" href="beer-button.html">

<dom-module id="beer-pub">

  <template>

    <style include="beer-button">

      :host {
        display: block;
        max-width: 640px;
      }
      
      a{
        text-decoration: none;
      }

      .info-banner{
        @apply --layout-horizontal; 
        @apply --layout-justified;
        @apply --layout-wrap;
      }

      .banner-item{
        @apply --layout-flex-auto;
        @apply --layout-horizontal; 
        @apply --layout-justified;
        border-top: 1px solid var(--app-line-color);
        border-bottom: 1px solid var(--app-line-color);
      }

      .divider{
        width:1px;
        margin: 30px 0; 
        background-color:var(--app-line-color);  
        border-top: 1px solid var(--app-line-color);
        border-bottom: 1px solid var(--app-line-color);
      }   

      .info-item-wrapper{
        padding:10px;
        height:80px;
        @apply --layout-vertical;
      }

      .info-icon{
        color: var(--app-accent-color);
        text-align: center;
      }

      .info-nonicon{
        color: var(--app-accent-color);
        font-size: 1em;
        font-weight: 500;
        margin: 11px 0;
        text-align: center;
      }

      .info-label{
        color: var(--app-accent-color);
        font-size: .8em;
        font-weight: 300;
        @apply --layout-flex-auto;
        text-align: center;
      }

      .open{
        text-transform: uppercase
      }

      /* .favorite{
         @apply --layout-horizontal; 
         @apply --layout-center-justified;
         @apply --layout-flex-auto;
         min-width: 100px;
      } */

       .favorite-icon{
        color: var(--app-secondary-color);
        text-align: center;
      }


      .icon{
        @apply --layout-horizontal;
        @apply --layout-center-justified;
        @apply --layout-flex-8;
      }

       .crawl{
        @apply --layout-flex-auto;
      }

      .item {
        display: block;
        text-decoration: none;
        text-align: center;
        margin-bottom: 40px;
      }

       .menu{
         @apply --layout-vertical;         
      }

      

      .category-wrapper{

        @apply --layout-vertical; 
         
      }

      .category{
        @apply --layout-horizontal;
        @apply --layout-center-justified;
        border-top: 1px solid var(--app-line-color);        
        padding:20px 0;

      }

      .category-item{
        @apply --layout-horizontal;
        @apply --layout-wrap;
        @apply --layout-center-justified;
        display: block;
        text-decoration: none;
        /*text-align: center;*/
        margin-bottom: 40px;
      }

      .category-button{
        @apply --layout-horizontal;
        @apply --layout-wrap;
        @apply --layout-center-justified;
        
        text-decoration: none;
        /*text-align: center;*/
        margin: 20px 0 0 0;
      }

      .category-title{
        font-size: 1.7em;
        font-weight: 500;
        margin: 10px 0;
        text-align: center;
        color: var(--app-primary-color);
      }

      .hours-wrapper{
        @apply --layout-vertical;
        margin: 10px;
        padding:10px;
      }

      .crawl-wrapper{
        @apply --layout-vertical;
        color: var(--app-primary-color);
        border-top: 1px solid var(--app-line-color);  
        margin: 10px
      }

      .crawl-item{
        padding:10px;
        margin: 10px 0;
      }

      .crawl-name{
        color: var(--app-primary-color);
        font-size: 1.5em;
        font-weight: 300;
      }

      .crawl-description{
        font-size: 1em;
        font-weight: 300;
        color: var(--app-primary-color);
      }


      .title {
        font-size: 2.5em;
        font-weight: 300;
        margin: 32px 5px 0 20px;
      }

      .motto {
        font-size: 2.0em;
        font-weight: 500;
        margin: 40px 5px 0 20px;
      }

      .description {
        font-size: 1.2em;
        font-weight: 300;
        margin: 10px;
        color: var(--app-primary-color);
        
      }

      .description > div {
         margin: 10px;
         
      }

      


    </style>

  <firebase-auth id="auth" app-name="beer" user="{{user}}"></firebase-auth>

 
    <div hidden="[[!online]]">
      <beer-banner
        google-photo="[[place.photos]]"
        photo-index="0"
        photo="[[organization.mainImage]]"
        org-id="[[orgId]]">
      </beer-banner>
    </div>


    <beer-fab owner="[[owner]]" on-tap="_edit"></beer-fab>
    
    <div class="info-banner" >
      <template is="dom-if" if="[[place.rating]]">
          <div class="banner-item">
            <div></div>
            <div class="info-item-wrapper">
              <div class="info-nonicon"> [[place.rating]]/5</div>
              <div class="info-label">Google users</div>
            </div>
            <div class="divider"></div>  
        </div>
      </template>

      <template is="dom-if" if="[[organization.favoritePercent]]">
        <div class="banner-item">
          <div></div>
          <div class="info-item">
            <div class="info-item-wrapper">
              <div class="info-nonicon"> [[organization.favoritePercent]]%</div>
              <div class="info-label">Beer-Fly</div>
            </div>
          </div>
          <div class="divider"></div> 
        </div>
      </template>

      <div class="banner-item">
        <div></div>
        <div class="info-item-wrapper">
          <div class="favorite-icon"> 
            <paper-icon-button id="favoriteButton" icon="beer-icons:thumb-up" on-tap="_toggleFavorite"></paper-icon-button>
          </div>
          <div class="info-label">Like</div>
        </div>

        <div class="info-item-wrapper">
          <div class="favorite-icon"> 
            <paper-icon-button id="notFavoriteButton" icon="beer-icons:thumb-down" on-tap="_toggleNotFavorite"></paper-icon-button>
          </div>
          <div class="info-label">Don't Like</div>
        </div>
        <div class="divider"></div> 
      </div>

      <template is="dom-if" if="[[_showIcons]]">

        <div class="banner-item">
          <div></div>
          <template is="dom-if" if="[[dogs]]">
              <div class="info-item-wrapper">
                <div class="info-icon"> 
                  <paper-icon-button icon="beer-icons:dogs"></paper-icon-button>
                </div>
                <div class="info-label">Dog Friendly</div>
              </div>
            </template>

            <template is="dom-if" if="[[patio]]">
              <div class="info-item-wrapper" hidden$="[[!patio]]">
                <div class="info-icon"> 
                  <paper-icon-button icon="beer-icons:patio"></paper-icon-button>
                </div>
                <div class="info-label">Patio</div>
              </div>
            </template>

            <template is="dom-if" if="[[over21]]">
              <div class="info-item-wrapper" hidden$="[[!over21]]">
                <div class="info-nonicon">+21</div>
                <div class="info-label">Over 21</div>
              </div>
            </template>
            <div class="divider"></div> 
        </div>
      </template>

      <div class="banner-item">
        <div></div>
        <div class="info-item">
          <div class="info-item-wrapper">
            <div class="info-icon"> 
              <paper-icon-button icon="beer-icons:crawl" on-tap="_openEditPubDialog"></paper-icon-button>
            </div>
            <div class="info-label">Beer-Crawl</div>
          </div>
        </div>
        <div class="divider"></div> 
      </div>

      <div class="banner-item">
        <div></div>
        <div class="info-item">
          <div class="info-item-wrapper">
            <div class="info-nonicon open">[[place.open]]</div>
            <div class="info-label">Currently Open/Closed</div>
          </div>
        </div>
        <div></div> 
      </div>



    </div>

    <div class="motto">[[organization.motto]]</div>

    <div class="description">
      <template is="dom-repeat" items="[[_addBreaks(organization.description)]]" as="description">
        <div>[[description]]</div>
      </template>
    </div>

      <div class="category-item-wrapper">

        <div class="hours-wrapper">
          <div>
            <div class="category-title">Hours</div>
            <beer-hours-card 
                class=" category-item"
                place="[[place]]">
            </beer-hours-card>
          </div>
        </div>

        <template is="dom-repeat" items="[[categories]]" strip-whitespace>
          
          <template is="dom-if" if="[[item.display]]">
            <div class="category">
             <div>
                <div class="category-item">

                  <a aria-label$="[[item.title]] View Details" href$="/[[nameUrl]]/[[item.name]]?orgid=[[orgId]]">
                    <div class="category-title">[[item.title]]</div>
                  </a>

                  <template is="dom-if" if="[[_isTap(item.$key)]]"> 
                    <template is="dom-repeat" items="[[_getArray(organization.onTap)]]" sort="_sortOrder" filter="_filterForTapped" as="tap">
                      <beer-beer-card-mini 
                          org-id="[[orgId]]" 
                          beer-name="[[tap.name]]"
                          style-name="[[tap.styleName]]"
                          brewery-name="[[tap.breweryName]]"
                          brewery-city="[[tap.city]]"
                          brewery-state="[[tap.stateAbbreviation]]"
                          abv="[[tap.abv]]"
                          owner="[[owner]]"
                          beer-id="[[tap.id]]"
                          name-url="[[nameUrl]]">
                      </beer-beer-card-mini>
                    </template>
                  </template>

                  <template is="dom-if" if="[[_isBeer(item.$key)]]"> 
                    <template is="dom-repeat" items="[[_getArray(organization.brewBeer)]]" sort="_sortOrder" filter="_filterBeer" as="beer">
                      <beer-beer-card-mini 
                          org-id="[[orgId]]" 
                          beer-name="[[beer.name]]"
                          style-name="[[beer.styleName]]"
                          abv="[[beer.abv]]"
                          owner="[[owner]]"
                          beer-id="[[beer.id]]"
                          name-url="[[nameUrl]]">
                      </beer-beer-card-mini>
                    </template>
                  </template>

                  <template is="dom-if" if="[[_isMenu(item.$key)]]"> 
           
                    <template is="dom-repeat" items="[[_getArray(organization.menu)]]" sort="_sortOrder" as="menu">
                      <beer-menu-card-mini 
                         category-name="[[menu.name]]"
                         menu-items="[[menu.item]]"
                         anchor-href="/[[nameUrl]]/[[item.name]]?orgid=[[orgId]]">
                      </beer-menu-card-mini>
                    </template>
                 
                  </template>

                  <template is="dom-if" if="[[_isSchedule(item.$key)]]"> 
                    
                      <beer-schedule-card-mini 
                         organization="[[organization]]">
                      </beer-schedule-card-mini>
                    
                 
                  </template>

                  <template is="dom-if" if="[[_isTruck(item.$key)]]"> 

                    <beer-foodtruck-schedule
                      organization=[[organization]]
                      name-url="[[nameUrl]]"
                      org-id="[[orgId]]">
                    </beer-foodtruck-schedule>
                  </template>

                  <template is="dom-if" if="[[_isContact(item.$key)]]"> 
                    <beer-contact-card 
                        place="[[place]]">
                    </beer-contact-card>
                  </template>

                  <template is="dom-if" if="[[_isReview(item.$key)]]"> 
                    <beer-review-card-mini
                       organization="[[place]]">
                     </beer-review-card-mini>
                  </template>

                      <div class="category-button">
                        <div>
                        <beer-button>
                          <a aria-label$=" View [[item.title]] Details" href$="/[[nameUrl]]/[[item.name]]?orgid=[[orgId]]">View [[item.title]] Details</a>
                        </beer-button>
                        </div>
                  </div>
                </div>
             </div>
            </div>
          </template>
          
        </template>

        <div class="crawl-wrapper">
          <div class="category-title">Beer-Crawls</div>
          <template is="dom-repeat" items="[[allCrawls]]" as="crawl">
            <a href="/[[nameUrl]]/crawl[[returnParams]]&crawlId=[[crawl.crawl_id]]">
            <div class="crawl-item">
              <div class="crawl-name">[[crawl.name]]</div>
              <div class="crawl-description">[[crawl.description]]</div>
            </div>
            </a>
          </template>
        </div>
        
      </div>

     <beer-dialog
      id="pubDialogEditor"
      entry-animation="slide-from-bottom-animation"
      exit-animation="slide-down-animation"
      with-backdrop
      opened="{{pubDialogOpened}}">
      
      <beer-crawl-dialog
        edit-place="[[place]]"
        crawl-data="{{crawlData}}">
      </beer-crawl-dialog>

    </beer-dialog>


     <paper-dialog 
        id="editDialog"
        with-backdrop
        style="width: 90vw;"
        entry-animation="slide-from-right-animation"
        exit-animation="slide-right-animation">
            
      <div> 
          <h3>[[organization.name]]</h3>
      </div>
      <paper-dialog-scrollable>
        <beer-pub-edit 
          org-id="[[orgId]]"
          name-url="[[nameUrl]]" 
          owner="[[owner]]">
        </beer-pub-edit>
      </paper-dialog-scrollable>
     

      <div>
        <paper-button dialog-dismiss autofocus>CLOSE</paper-button>
      </div>
    </paper-dialog>

  </template>
  

  <script>

    Polymer({

      is: 'beer-pub',

      properties: {

        allCrawls:{
          type:Array,
          value: function (){return [];}
        },

        crawlObj:{
          type:Object,
          value: function (){return {};}
        },

        organization:{
          type: Object
        },

        categoryKey:{
          type: String
        },

        allCategories:{
          type: Object,
        },

        categories: {
          type: Array,
          computed: '_computeCategories(organization)'
        },

        crawlData:{
          type: Object
        },

        organization:{
          type: Object,
          notify: true
        },

        dogs:{
          type: Boolean,
          value: false,
          reflectToAttribute: true,
          computed: '_computeIcon(organization.dogFriendly)',
        },

        patio:{
          type: Boolean,
          value: false,
          reflectToAttribute: true,
          computed: '_computeIcon(organization.patio)',
        },
        
        over21:{
          type: Boolean,
          value: false,
          reflectToAttribute: true,
          computed: '_computeIcon(organization.over21)',
        },

        favorite:{
          type:String,
        },

        returnParams:{
          type:String
        },

        userFavorite:{
          type:String
        },

        login: {
         type: Boolean,
         notify: true
       },

       nameUrl:{
        type: String
       },

       online:{
         type: Boolean
       },

       orgId:{
         type: String
       },

       owner:{
         type: Boolean
       }, 

        place:{
          type: Object
        },

        permenentlyClosed:{
          type:Boolean,
          value:false,
          computed: '_computePermanentlyClosed(place)'
        },

        pubDialogOpened:{
          type:Boolean,
          value:false
        },

        user:{
          type: Object
        },

        userData:{
          type: Object
        },


        _showIcons:{
          type:Boolean,
          value:false,
          computed:"_computeShowIcons(organization)"
        }
      },

      observers:['_addNewOrg(place, user)',
                  '_closeLocation(permenentlyClosed)',
                  '_watchFavorite(favorite)',
                  '_watchFavoriteData(userData.favoriteOrganization, place.place_id)',
                  '_watchForCrawls(organization.crawl)'          
                  ],

      ready: function (){
        var body = document.querySelector('body');
          Polymer.dom(body).appendChild(this.$.pubDialogEditor);
       
        // this.$.pubDialogEditor.open()
      },

      _watchForCrawls: function (crawl){
        var that = this;
        console.log(crawl);
        this.splice('allCrawls', 0, this.allCrawls.length);
        this.set('crawlObj', {});
        
        // if(placeId){
        if(typeof crawl === 'object'){
          for (let key of Object.keys(crawl)){
            firebase.database(this.$.auth.app).ref(`/crawl/${key}`)
              .on('value', snapshot =>{
                
                if(snapshot.child('public').exists() && !snapshot.child('deleted').exists()){
                  var crawlObj = snapshot.val();
                  crawlObj.crawl_id = snapshot.key;
                  if(!that.crawlObj[snapshot.key]){
                    console.log('push',crawlObj);
                    var position = that.push('allCrawls', crawlObj);
                    that.set(`crawlObj.${snapshot.key}`, {position:position});
                  }else{
                    that.set(`allCrawls.${that.crawlObj[snapshot.key].position-1}`, crawlObj);
                    console.log('set',crawlObj);
                  }
                }
              })
          }
        }
        //   firebase.database(this.$.auth.app).ref(`/crawl`)
        //     .orderByChild('organization').equalTo(placeId)
        //     .on('value', snapshot =>{
        //       if(!snapshot.exists()){
        //         return that.splice("allCrawls", 0, that.allCrawls.length);
        //       }

        //       snapshot.forEach(crawl =>{
        //         var crawlObj = crawl.val();
        //         crawlObj.crawl_id = crawl.key;
                
        //         that.push('allCrawls', crawlObj);
        //       })
        //     })
        // }
      },

      _watchFavoriteData:function (favorite, placeId){

        if(favorite && placeId){
          if(favorite[placeId]){
            this.userFavorite = favorite[placeId].favorite;
            if(this.userFavorite === 'yes'){
              this.$.favoriteButton.style.color = 'green';
              this.$.notFavoriteButton.style.color=null;
            }else if (this.userFavorite === 'no'){
              this.$.favoriteButton.style.color = null;
              this.$.notFavoriteButton.style.color='red';
            }
            else{
              this.$.favoriteButton.style.color = null;
              this.$.notFavoriteButton.style.color=null;
            }
          }else{
            this.userFavorite = null;
            this.$.favoriteButton.style.color = null;
            this.$.notFavoriteButton.style.color=null;
          }
           
        }else{
          this.userFavorite = null;
          this.$.favoriteButton.style.color = null;
          this.$.notFavoriteButton.style.color=null;
        }
        

          // console.log(this.userFavorite);
          // this.favorite = this.userFavorite

      },

      _watchFavorite:function (favorite){
        console.log('favorite', favorite)
        console.log('user', this.userFavorite);
        var update = false;
        if(favorite){
          update = true;
        }
        if(favorite === this.userFavorite){
          update = false;
        }

        if(this.user){
          if(this.place){
            if(this.place.place_id){
              
              
              if(update){
                var obj={
                  created: Math.round(Date.now()/1000),
                  name:this.place.name,
                  place_id:this.place.place_id,
                  favorite:this.favorite,
                  vicinity:this.place.vicinity,
                  latitude:this.place.latitude,
                  longitude:this.place.longitude
                };

                firebase.database(this.$.auth.app).ref(`user/${this.user.uid}/favoriteOrganization/${this.place.place_id}`)
                  .update(obj)
                  .then(() =>{
                    console.log('Updated Favorite');
                  })
                  .catch(error =>{
                    console.log('FAVORITE_ERROR', error)
                  })
              
          

              }else{
                firebase.database(this.$.auth.app).ref(`user/${this.user.uid}/favoriteOrganization/${this.place.place_id}`)
                  .remove()
                  .then(() =>{
                    console.log('Removed from favorite');
                    
                  })
                  .catch(error =>{
                    console.log('FAVORITE_DELETE_ERROR', error)
                  })
              }
            }
          }

        }else{
          this.login = true;
        }
      },

      _toggleFavorite: function(){
        if(this.user){
          if (this.favorite === 'yes'){
            this.favorite = null;
          }else{
            this.favorite = 'yes'
          }
        }else{
          this.login = true;
        }
      },

      _toggleNotFavorite: function(){
        if(this.user){
          if (this.favorite === 'no'){
            this.favorite = null;
          }else{
            this.favorite = 'no'
          }
        }else{
          this.login = true;
        }
      },


      _computeShowIcons: function (organization){
        // console.log('show test', organization)
        if(organization){
          if(organization.dogFriendly){
            return true;
          }
          if(organization.patio){
            return true;
          }
          if(organization.over21){
            return true;
          }
        }
        return false;
      },

      _addNewOrg: function (place, user){
        if(user){
          if(user.emailVerified){
            if(place){
              if(place.place_id){
                var domain = this._getDomain(place.website);
                if(domain){
                  
                  
                  firebase.database(this.$.auth.app).ref(`/newOrg/${place.place_id}`)
                    .update({domain:domain})
                    .then(function (){
                      console.log('SAVED_NEW_PUB')
                    })
                    .catch(function (error){
                      console.log('SAVED_NEW_PUB_ERROR', error);
                    })
                  }
                }
              }
            }
          }
        
      },

      _closeLocation: function (closed){
        if(closed){
          firebase.database(this.$.auth.app).ref(`/newOrg/${this.place.place_id}`)
            .update({domain:'permenently_closed'})
            .then(function (){
              console.log('SUBMIT_CLOSED')
            })
            .catch(function (error){
              console.log('SUBMIT_CLOSED_ERROR', error);
            })
          
        }
      },

      _getDomain: function (website){
        if(website){
          var ignore = ['wordpress', 'facebook']
          var domainSide = website.split('//')[1];
          var domainArray = domainSide.split('/')[0];
          var domain = domainArray.replace('www.','');
          for(var i=0; i<ignore.length; i++){
            
            if(domain.indexOf(ignore[i]) !== -1){
              return null;
            } 
          }
          return domain;
        }else{
          return null;
        }
      },

      _openEditPubDialog:function (event){
        this.pubDialogOpened = !this.pubDialogOpened
      },


      _computeCategories: function(organization) {
        var returnArray = [];
        if(organization){
          if(organization.category){
            var category = organization.category;
            var key = Object.keys(category);
            for (var i=0; i<key.length; i++){
                category[key[i]].$key = key[i];
                returnArray.push(category[key[i]])
            }
          }
        }
        return returnArray.sort(function(a, b) {
                                  return parseFloat(a.order) - parseFloat(b.order);
                              });
      },


      _edit: function(e){
        'use strict';
        // console.log('tapped');
        if(this.user){
          var body = document.querySelector('body');
          Polymer.dom(body).appendChild(this.$.editDialog);
          this.$.editDialog.open();
        }
      },

      _addBreaks: function(str){
        'use strict';
        if(str){
          return str.split('\n');
        }else{
          return [];
        }
      },

       _isTap: function (type){
        if(type === 'TAP'){
          return true;
        }else{
          return false;
        }
      },

      _isBeer: function (type){
        if(type === 'BEER'){
          return true;
        }else{
          return false;
        }
      },

      _isMenu: function (type){
        if(type === 'MENU'){
          return true;
        }else{
          return false;
        }
      },

      _isTruck: function (type){
        if(type === 'FOOD_TRUCK'){
          return true;
        }else{
          return false;
        }
      },

      _isSchedule: function (type){
        if(type === 'SCHEDULE'){
          return true;
        }else{
          return false;
        }
      },

      _isContact: function (type){
        if(type === 'CONTACT'){
          return true;
        }else{
          return false;
        }
      },

      _isReview: function (type){
        if(type === 'REVIEW'){
          return true;
        }else{
          return false;
        }
      },

      _getArray: function(obj){
        'use strict';
        if(obj){
          var returnArray = [];
          var key = Object.keys(obj);
          for (var i=0; i<key.length; i++){
              obj[key[i]].$key = key[i]
              returnArray.push(obj[key[i]])   
          }
          
          return returnArray;
        }
      },

      _filterForTapped: function(beer){
        if(beer.tapped === 'TAPPED'){
          return true;
        }else{
          return false;
        }

      },

      _sortOrder: function(a,b){
        'use strict';
        if (a.order < b.order)
          return -1;
        if (a.order > b.order)
          return 1;
        return 0;
      },



      _computeIcon: function (icon) {
        if (icon){
          return true;
        }
          return false;
      },

    

      _computePermanentlyClosed: function (place){
      if(place){
        if(place.permanently_closed){
          return true;
        }
      }
        return false;
      },


      _filterBeer: function (beer){

        if(!beer.status){
          return true;
        }else{
          if(beer.status ==='not_verified' || beer.status ==='deleted'){
            return false
          }else{
            return true
          }
        }
      },

      _test: function(obj){
        console.log('TEST', obj);
      }

    });

  </script>

</dom-module>
