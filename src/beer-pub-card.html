<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/iron-image/iron-image.html">
<link rel="import" href="../bower_components/iron-icon/iron-icon.html">
<link rel="import" href="../bower_components/paper-material/paper-material.html">
<link rel="import" href="../bower_components/paper-icon-button/paper-icon-button.html">

<link rel="import" href="beer-pub-icons.html">
<link rel="import" href="beer-pub-rating.html">
<link rel="import" href="beer-pub-favorite.html">

<dom-module id="beer-pub-card">

  <template>

    <style>

      a{
      color: var(--app-primary-color);
      text-decoration: none;
    }

      .card{
        padding: 10px;
        margin: 10px;
      }

      .items > div{
        margin: 0 10px 10px 10px
      }


      .name {
        font-size: 1.5em;
        font-weight: 300;
        color: var(--app-primary-color);
      }

      .motto {
        font-size: 1.0em;
        font-weight: 400;
        color: var(--app-primary-color);
      }

      .address {
        font-size: 1.0em;
        font-weight: 300;
        color: var(--app-primary-color);
      }
      .distance{
        font-size: 1.0em;
        font-weight: 300;
        color: var(--app-secondary-color);
      }

      .icons-wrapper{
        @apply(--layout-horizontal);
        @apply(--layout-justified);
        @apply(--layout-wrap);
      }

      .sponsor-wrapper{
        font-size: .8em;
        font-weight: 300;
        color: var(--app-secondary-color);
        /*visibility: hidden;*/
        /*@apply(--layout-horizontal);
        @apply(--layout-center-justified);*/
      }



    </style>

    

      <paper-material class='card' elevation="1" animated-shadow="false">
     
        <div  class="sponsor-wrapper" >
            <div id="sponsor" hidden$="[[!sponsor]]">Sponsoring Organization</div>
        </div>
         <div class="icons-wrapper">
            <div>
              <beer-pub-rating 
                  org-id="[[placeId]]"
                  google-rating="[[googleRating]]"
                  login="{{login}}">
              </beer-pub-rating>
            </div>
            <div>
              <beer-pub-icons
                dogs="[[dogFriendly]]"
                patio="[[patio]]"
                over21="[[over21]]">
              </beer-pub-icons>
            </div>
           
   
          </div>
          <a aria-label$="[[name]]" href$="/[[urlName]]/main?orgid=[[placeId]]">
            <div class="items">
                <div class="name">[[name]]</div>
                <div class="motto">[[motto]]</div>
                <div class="address" hidden$="[[!address]]">[[address]]</div>
                <div class="address" hidden$="[[address]]">[[city]], [[state]]</div>
                <div class="distance" hidden$="[[!distance]]">[[_computeDisplayDistance(distance)]] miles from you</div>
            </div>
           </a>
           
      </paper-material>
 
    
  </template>

  <script>

    Polymer({

      is: 'beer-pub-card',

       properties: {

          address:{
            type: String
          },

          city:{
            type: String
          },

          distance:{
            type: Number,
            value: false
          },

          dogFriendly:{
            type: Boolean
          },

          googleRating:{
            type: Number
          },

          login: {
            type: Boolean,
            notify: true
          },

          motto:{
            type: String
          },

          name:{
              type: String
          },

          over21:{
            type: Boolean
          },

          patio:{
            type: Boolean
          },

          placeId:{
            type: String
          },

          sponsor:{
            type: Boolean,
            value: false
          },

          state:{
            type: String
          },
          
          urlName:{
              type: String,
              computed: '_computeNameForUrl(name)'
          }
         
        },

        observers: ['_watchforSponsor(sponsor)'],

         _watchforSponsor: function (sponsor){
        
          if(sponsor){
            console.log('sponsor', sponsor)
            // this.$.sponsor.hidden = false;
          }
        },

         _computeDisplayDistance: function (distance){
          return Math.round(distance*10)/10

        },

        _computeNameForUrl: function (name) {
         'use strict';
          if (name) {
            name = name.replace(/\s/g, '-')
            return name.replace(/[^a-zA-Z\d\s:]/g, '');
          } else {
            return 'pub-name-missing'
          }
      },

    });

  </script>

</dom-module>
