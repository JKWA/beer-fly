<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/iron-image/iron-image.html">
<link rel="import" href="../bower_components/iron-icons/iron-icons.html">
<link rel="import" href="../bower_components/paper-material/paper-material.html">
<link rel="import" href="../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="../bower_components/polymerfire/firebase-document.html">
<link rel="import" href="../bower_components/app-storage/app-localstorage/app-localstorage-document.html">
<!--<link rel="import" href="../bower_components/google-apis/google-maps-api.html">-->



<link rel="import" href="beer-pub-card.html">
<link rel="import" href="beer-place-data.html">



<dom-module id="beer-near-breweries-card">

  <template>

    <!--<style>


    </style>-->

    <firebase-document
      app-name="beer"
      path="organization/[[placeId]]"
      data="{{pub}}">
   </firebase-document>
   <!--<google-maps-api id="map" api-key="AIzaSyBPa6XlVFjF48fEyNT3qtnkFTZ0_dGMAzI" version="3.exp"></google-maps-api>-->


  
  <!--<beer-place-data
    place-id="[[placeId]]"
    data="{{place}}">
  </beer-place-data>-->

   <!--<app-localstorage-document
      id="localPlaceData"
      key="organization_[[placeId]]" 
      data="{{pub}}">
   </app-localstorage-document>-->

   <beer-pub-card 
        place-id="[[pub.place_id]]"
        name="[[pub.name]]"
        motto="[[pub.motto]]"
        address="[[pub.vicinity]]"
        dog-friendly="[[pub.dogFriendly]]"
        patio="[[pub.patio]]"
        over21="[[pub.over21]]"
        distance="[[distance]]"
        login="{{login}}"
       >
    </beer-pub-card>


  

    
  </template>

  <script>

    Polymer({

      is: 'beer-near-breweries-card',

       properties: {

        // organization:{
        //   type: Object
        // },
        distance:{
          type:Number
        },

        // place:{
        //   type: Object
        // },

        placeId: {
          type: String
        },

        // mapHasLoaded:{
        //   type: Boolean,
        //   value: false
        // },

        login: {
         type: Boolean,
         notify: true
       },



        
        //  _urlName:{
        //      type: String,
        //      computed: '_computeNameForUrl(organization.name)'
        //  }
        },
      //   listeners: {'api-load':'_mapHasLoaded' },
      //   observers: ['_getGoogleDetails(mapHasLoaded, placeId)'],

      //   _mapHasLoaded: function () {
      //     // console.log("LOADED");
      //     // console.log(placeId)
      //     this.mapHasLoaded = true;
      //     // this._getGoogleDetails();
      //   },

      //    _getGoogleDetails: function (mapHasLoaded, placeId){
      //   // var placeId = this.placeId;
      //   // console.log('TRY')

      //   if(mapHasLoaded){
      //     if(placeId){
      //       // console.log(placeId);
       
      //     if(placeId){
      //       var map = this.$.map;
      //       var that = this;
      //       var parameter = {};
      //       parameter.placeId = placeId;
      //       console.log(parameter);
      //           var places = new google.maps.places.PlacesService(map);
      //         places.getDetails(parameter, function (result){
      //             // var details = this.$.map.getDetails(placeId);
      //             // var that = this;
      //             // details.then(
      //             //   function(result) {
      //                   that.place = result;


      //                   console.log('result', result);
      //                   // that.$.localPlaceData.setStoredValue('place_'+placeId, result);               
      //               }, function(error) {
      //                 console.log(error); 
      //               });
      //           // })
      //     }
      //     }else{
      //       console.log(this.pub)
      //     }
      //   }
      // },
      

        _computeDisplayDistance: function (distance){
          
          return Math.round(distance*10)/10

        },
        _computeNameForUrl: function (name) {
         'use strict';
          if (name) {
            name = name.replace(/\s/g, '-')
            return name.replace(/[^a-zA-Z\d\s:]/g, '');
          } else {
            return 'pub-name-missing'
          }
      },

    });

  </script>

</dom-module>
