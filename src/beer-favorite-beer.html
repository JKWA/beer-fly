<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/polymerfire/firebase-auth.html">
<link rel="import" href="../bower_components/polymerfire/firebase-query.html">
<link rel="import" href="../bower_components/polymerfire/firebase-document.html">
<link rel="import" href="../bower_components/paper-styles/element-styles/paper-material-styles.html">

<link rel="import" href="beer-icons.html">
<!--<link rel="import" href="beer-allbeers-card.html">-->
<link rel="import" href="beer-favorite-beer-card.html">

<dom-module id="beer-favorite-beer">


  
  

  <template strip-whitespace>
    
    <style include="paper-material-styles">

    :host {
        display: block;
        max-width: 640px;
      }
      
    .location-card{
          padding: 10px;
          margin: 10px;
          @apply --paper-material-elevation-0;
        }

    .card{
          padding: 10px;
          margin: 10px;
          @apply --paper-material-elevation-1;
        }

    </style>

    <firebase-auth 
        id="auth" 
        app-name="beer"
        user="{{user}}">
    </firebase-auth>

    <firebase-query
        id="rating"
        app-name="beer"
        path="user/[[user.uid]]/rating"
        data="{{ratings}}">
    </firebase-query>

    <div class="location-card">
      <div class="your-location">Your location: [[location.address]]</div>
    </div>
    
     <template 
        is="dom-repeat" 
        items=[[ratings]] 
        sort="_sortByRating" 
        filter="_filterAboveThree"
        observe="rating">
        <div class="card">
          <beer-favorite-beer-card 
            beer-id="[[item.$key]]" 
            location="[[location]]">
          </beer-favorite-beer-card>
        </div>

    </template>




  </template>
  <script>

  Polymer({

    is: 'beer-favorite-beer',

    //  properties: {
    //     user:{
    //       type: Object
    //     },
    //   },

 

  // _toArray: function (obj){
    
  //   if(obj){
  //     console.log(obj);
  //     var returnArray=[];
  //     var key = Object.keys(obj);
  //     for (var i=0; i<key.length; i++){
  //       var beer = {};
  //       beer.id = key[i];
  //       beer.rating = obj[key[i]].rating;
  //       if(beer.rating >=4){
  //        returnArray.push(beer);
  //       }
  //     }
  //     return returnArray;
  //   }
  // },

  _sortByRating: function(a,b){
      'use strict';
      if (a.rating > b.rating)
        return -1;
      if (a.rating < b.rating)
        return 1;
      return 0;
    },

    _filterAboveThree: function(obj){
        if(obj.rating >3){
          return true;
        }else{
          return false;
        }
    },
    
    _test: function (obj){
      console.log("RATING", obj);
    }

  });

  </script>

</dom-module>
