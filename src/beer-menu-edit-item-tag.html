<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/paper-checkbox/paper-checkbox.html">
<link rel="import" href="../bower_components/polymerfire/firebase-query.html">
<link rel="import" href="../bower_components/polymerfire/firebase-document.html">


<dom-module id="beer-menu-edit-item-tag">

  <template>

    <style>
    .tag{
      margin: 5px 10px 0 0 
    }
     

    </style>


    <firebase-document
          id="menuItem"
          app-name="beer"
          path="organization/[[orgId]]/category/MENU/menu/[[menuKey]]/items/[[menuItemKey]]/TAG"
          data={{menuTag}}>
    </firebase-document>

    <firebase-query
          app-name="beer"
          path="category/MENUTAG"
          data="{{allTags}}">
    </firebase-query>

   
      <template is="dom-repeat" items="[[allTags]]" as="tag">
       
          <paper-checkbox 
            tag="[[tag]]"
            class="tag" 
            tag-key="[[tag.$key]]"
            menu-item-key="[[menuItemKey]]" 
            checked="[[_checked(menuTag, tag.$key)]]"
            on-tap="_setTag">
            [[tag.title]]
          </paper-checkbox>
       
      </template>
        
      
   
            
      

  </template>

  <script>

    Polymer({

      is: 'beer-menu-edit-item-tag',

       properties: {
        orgId:{
          type: String
        },
        checkedValue:{
          type: Boolean,
          // computed: '_computeCheckedValues'
        },
        menuTag:{
          type:Object
        },
        allTags:{
          type: Array
        }
       },

      // _addMenuItem: function (){
      //   var obj = {};
      //     obj.name = '';
      //     obj.description = '';
      //     obj.type = 'menu-item';
      //   console.log(this.$.menu.ref.push(obj));

      // },

      _setTag: function (e){
        var target = e.currentTarget;
        var checked = target.checked;
        var tag = target.tag;
        var key = target.menuItemKey;
        var tagKey = target.tagKey;

        if(checked){
          delete tag.$key;
          this.$.menuItem.ref.child(tagKey).update(tag);
        }else{
          this.$.menuItem.ref.child(tagKey).remove();
        }
 
      },

      _checked: function (tag, key){
        return tag[key];
      },

      _test: function (obj) {
        console.log('ITEMS', obj);
      }
      

   

    });

  </script>

</dom-module>
